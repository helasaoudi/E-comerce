<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Product Details - Fruitables</title>
    <meta content="width=device-width, initial-scale=1.0" name="viewport">
    <link href="css/bootstrap.min.css" rel="stylesheet">
    <link href="css/style.css" rel="stylesheet">
</head>
<body>
    <div class="container py-5">
        <a href="index.html" class="btn btn-link mb-4">&larr; Back to products</a>
        <div id="product-details" class="row justify-content-center align-items-center">
            <!-- product details will be injected here -->
        </div>
    </div>
    <style>
    .product-card {
        background: #fff;
        border-radius: 18px;
        box-shadow: 0 4px 24px rgba(0,0,0,0.08);
        padding: 2.5rem 2rem;
        margin-bottom: 2rem;
    }
    .product-card h1 {
        font-size: 2.5rem;
        font-weight: 700;
    }
    .product-card .price {
        font-size: 2rem;
        color: #eab308;
        font-weight: 600;
    }
    .product-card .category {
        font-size: 1.1rem;
        color: #888;
        margin-bottom: 1rem;
    }
    .product-card .desc {
        font-size: 1.15rem;
        margin-bottom: 1.5rem;
    }
    .product-card .add-cart-row {
        margin-top: 2rem;
    }
    </style>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.4/jquery.min.js"></script>
    <script src="js/products.js"></script>
    <script src="js/cart.js"></script>
    <script>
        (function(){
            function getQueryParam(name){
                var params = new URLSearchParams(window.location.search);
                return params.get(name);
            }
            function renderNotFound(container){
                container.innerHTML = '<div class="col-12"><h2>Product not found</h2><p>The product you are looking for does not exist.</p></div>';
            }
            function renderProduct(product){
                var html = ''+
                    '<div class="col-lg-10 product-card row">'+
                        '<div class="col-md-5 text-center mb-4 mb-md-0">'+
                            '<img src="'+product.img+'" class="img-fluid rounded shadow" alt="'+product.name+'" style="max-height:340px;object-fit:contain;background:#f8fafc;">'+
                        '</div>'+
                        '<div class="col-md-7">'+
                            '<h1>'+product.name+'</h1>'+
                            '<div class="category">Category: '+product.category+'</div>'+
                            '<div class="price">'+product.price+' TND <span class="fs-6 text-dark">/ '+product.unit+'</span></div>'+
                            '<div class="desc">'+product.description+'</div>'+
                            '<div class="add-cart-row d-flex align-items-center">'+
                                '<input id="pd-qty" type="number" class="form-control w-25 me-3" value="1" min="1">'+
                                '<button id="pd-add" class="btn btn-primary px-4 py-2">Add to cart</button>'+
                            '</div>'+
                        '</div>'+
                    '</div>';
                document.getElementById('product-details').innerHTML = html;
                // wire add to cart
                document.getElementById('pd-add').addEventListener('click', function(){
                    var q = parseInt(document.getElementById('pd-qty').value, 10) || 1;
                    Cart.addToCart(product.id, q);
                    // navigate to cart page
                    window.location.href = 'cart.html';
                });
            }

            var id = getQueryParam('id');
            var container = document.getElementById('product-details');
            if(!id){
                renderNotFound(container);
                return;
            }
            // find product by id
            var pid = parseInt(id, 10);
            var product = PRODUCTS.find(function(p){ return p.id === pid; });
            if(!product){
                renderNotFound(container);
                return;
            }
            renderProduct(product);
        })();
    </script>
</body>
</html>
